import streamlit as st
import os

# ржкрзЗржЬрзЗрж░ ржирж╛ржо ржУ ржЖржЗржХржи рж╕рзЗржЯржЖржк
st.set_page_config(page_title="PSNS: Study Notes Searcher", page_icon="ЁЯУЪ")

# рж╕рж╛ржЗржбржмрж╛рж░ (ржмрж╛ржо ржкрж╛рж╢рзЗрж░ ржорзЗржирзБ)
with st.sidebar:
    st.header("Settings")
    api_key = st.text_input("OpenAI API Key", type="password")
    st.info("ржкрзНрж░ржержорзЗ ржПржЦрж╛ржирзЗ API Key ржжрж┐рждрзЗ рж╣ржмрзЗ, ржкрж░рзЗ ржЖржорж░рж╛ ржПржЯрж╛ ржЕржЯрзЛржорзЗржЯрж┐ржХ ржХрж░ржмред")

# ржорзЗржЗржи ржкрзЗржЬ
st.title("ЁЯУЪ Personal Study Notes Searcher")
st.write("рждрзЛржорж╛рж░ рж▓рзЗржХржЪрж╛рж░ рж╕рзНрж▓рж╛ржЗржб ржмрж╛ ржирзЛржЯ ржЖржкрж▓рзЛржб ржХрж░рзЛ ржПржмржВ ржкрзНрж░рж╢рзНржи ржХрж░рзЛ!")

# рзз. ржлрж╛ржЗрж▓ ржЖржкрж▓рзЛржб рж╕рзЗржХрж╢ржи
uploaded_file = st.file_uploader("PDF ржлрж╛ржЗрж▓ ржЖржкрж▓рзЛржб ржХрж░рзБржи", type=['pdf'])

# ржлрж╛ржЗрж▓ рж╕рзЗржн ржХрж░рж╛рж░ ржЯрзЗржорзНржкрзЛрж░рж╛рж░рж┐ ржлрзЛрж▓рзНржбрж╛рж░ рждрзИрж░рж┐
if not os.path.exists("temp_files"):
    os.makedirs("temp_files")

if uploaded_file is not None:
    # ржлрж╛ржЗрж▓ржЯрж┐ temp ржлрзЛрж▓рзНржбрж╛рж░рзЗ рж╕рзЗржн ржХрж░рж╛
    save_path = os.path.join("temp_files", uploaded_file.name)
    with open(save_path, "wb") as f:
        f.write(uploaded_file.getbuffer())
    
    st.success(f"тЬЕ ржлрж╛ржЗрж▓ ржЖржкрж▓рзЛржб рж╣рзЯрзЗржЫрзЗ: {uploaded_file.name}")
    st.write("---")
    
    # рзи. ржЪрзНржпрж╛ржЯ ржЗржирзНржЯрж╛рж░ржлрзЗрж╕ (ржПржЦржиржУ ржбрж╛ржорж┐)
    st.subheader("ржкрзНрж░рж╢рзНржи ржЬрж┐ржЬрзНржЮрж╛рж╕рж╛ ржХрж░рзБржи")
    user_question = st.text_input("ржЖржкржирж╛рж░ ржкрзНрж░рж╢рзНржи рж▓рж┐ржЦрзБржи...")
    
    if user_question:
        st.write(f"ЁЯФН ржЖржкржирж┐ ржЬрж╛ржирждрзЗ ржЪрзЗрзЯрзЗржЫрзЗржи: **{user_question}**")
        st.info("AI ржПржЦржи ржХрж╛ржирзЗржХрзНржЯрзЗржб ржирзЗржЗ, рждрж╛ржЗ ржЙрждрзНрждрж░ ржжрж┐рждрзЗ ржкрж╛рж░ржЫрж┐ ржирж╛ред ржкрж░рзЗрж░ ржзрж╛ржкрзЗ ржЖржорж░рж╛ ржмрзНрж░рзЗржЗржи ржХрж╛ржирзЗржХрзНржЯ ржХрж░ржм!")